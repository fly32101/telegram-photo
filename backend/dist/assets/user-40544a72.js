import{A as P,K as O,D as M,_ as x,F as E,b as X,c as L,e as T,N as G,P as A,aX as B,b2 as m}from"./_plugin-vue_export-helper-9f530b04.js";import{d as H,s as U,w as j,o as R,c,Q as _,P as N,l as F}from"./index-38b4b754.js";function V(t,e,o){var i=o||{},n=i.noTrailing,g=n===void 0?!1:n,I=i.noLeading,y=I===void 0?!1:I,b=i.debounceMode,s=b===void 0?void 0:b,a,h=!1,f=0;function D(){a&&clearTimeout(a)}function z(d){var v=d||{},u=v.upcomingOnly,$=u===void 0?!1:u;D(),h=!$}function S(){for(var d=arguments.length,v=new Array(d),u=0;u<d;u++)v[u]=arguments[u];var $=this,l=Date.now()-f;if(h)return;function p(){f=Date.now(),e.apply($,v)}function r(){a=void 0}!y&&s&&!a&&p(),D(),s===void 0&&l>t?y?(f=Date.now(),g||(a=setTimeout(s?r:p,t))):p():g!==!0&&(a=setTimeout(s?r:p,s===void 0?t-l:t))}return S.cancel=z,S}function K(t,e,o){var i=o||{},n=i.atBegin,g=n===void 0?!1:n;return V(t,e,{debounceMode:g!==!1})}const Q=new O("antSpinMove",{to:{opacity:1}}),q=new O("antRotate",{to:{transform:"rotate(405deg)"}}),J=t=>({[`${t.componentCls}`]:x(x({},E(t)),{position:"absolute",display:"none",color:t.colorPrimary,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`,"&-spinning":{position:"static",display:"inline-block",opacity:1},"&-nested-loading":{position:"relative",[`> div > ${t.componentCls}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:t.contentHeight,[`${t.componentCls}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:-t.spinDotSize/2},[`${t.componentCls}-text`]:{position:"absolute",top:"50%",width:"100%",paddingTop:(t.spinDotSize-t.fontSize)/2+2,textShadow:`0 1px 2px ${t.colorBgContainer}`},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.spinDotSize/2)-10},"&-sm":{[`${t.componentCls}-dot`]:{margin:-t.spinDotSizeSM/2},[`${t.componentCls}-text`]:{paddingTop:(t.spinDotSizeSM-t.fontSize)/2+2},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.spinDotSizeSM/2)-10}},"&-lg":{[`${t.componentCls}-dot`]:{margin:-(t.spinDotSizeLG/2)},[`${t.componentCls}-text`]:{paddingTop:(t.spinDotSizeLG-t.fontSize)/2+2},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.spinDotSizeLG/2)-10}}},[`${t.componentCls}-container`]:{position:"relative",transition:`opacity ${t.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:t.colorBgContainer,opacity:0,transition:`all ${t.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${t.componentCls}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:t.spinDotDefault},[`${t.componentCls}-dot`]:{position:"relative",display:"inline-block",fontSize:t.spinDotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:(t.spinDotSize-t.marginXXS/2)/2,height:(t.spinDotSize-t.marginXXS/2)/2,backgroundColor:t.colorPrimary,borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:Q,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:q,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&-sm ${t.componentCls}-dot`]:{fontSize:t.spinDotSizeSM,i:{width:(t.spinDotSizeSM-t.marginXXS/2)/2,height:(t.spinDotSizeSM-t.marginXXS/2)/2}},[`&-lg ${t.componentCls}-dot`]:{fontSize:t.spinDotSizeLG,i:{width:(t.spinDotSizeLG-t.marginXXS)/2,height:(t.spinDotSizeLG-t.marginXXS)/2}},[`&${t.componentCls}-show-text ${t.componentCls}-text`]:{display:"block"}})}),W=P("Spin",t=>{const e=M(t,{spinDotDefault:t.colorTextDescription,spinDotSize:t.controlHeightLG/2,spinDotSizeSM:t.controlHeightLG*.35,spinDotSizeLG:t.controlHeight});return[J(e)]},{contentHeight:400});var Y=globalThis&&globalThis.__rest||function(t,e){var o={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(o[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(o[i[n]]=t[i[n]]);return o};const Z=()=>({prefixCls:String,spinning:{type:Boolean,default:void 0},size:String,wrapperClassName:String,tip:A.any,delay:Number,indicator:A.any});let C=null;function k(t,e){return!!t&&!!e&&!isNaN(Number(e))}function tt(t){const e=t.indicator;C=typeof e=="function"?e:()=>c(e,null,null)}const w=H({compatConfig:{MODE:3},name:"ASpin",inheritAttrs:!1,props:X(Z(),{size:"default",spinning:!0,wrapperClassName:""}),setup(t,e){let{attrs:o,slots:i}=e;const{prefixCls:n,size:g,direction:I}=L("spin",t),[y,b]=W(n),s=U(t.spinning&&!k(t.spinning,t.delay));let a;return j([()=>t.spinning,()=>t.delay],()=>{a==null||a.cancel(),a=K(t.delay,()=>{s.value=t.spinning}),a==null||a()},{immediate:!0,flush:"post"}),R(()=>{a==null||a.cancel()}),()=>{var h,f;const{class:D}=o,z=Y(o,["class"]),{tip:S=(h=i.tip)===null||h===void 0?void 0:h.call(i)}=t,d=(f=i.default)===null||f===void 0?void 0:f.call(i),v={[b.value]:!0,[n.value]:!0,[`${n.value}-sm`]:g.value==="small",[`${n.value}-lg`]:g.value==="large",[`${n.value}-spinning`]:s.value,[`${n.value}-show-text`]:!!S,[`${n.value}-rtl`]:I.value==="rtl",[D]:!!D};function u(l){const p=`${l}-dot`;let r=B(i,t,"indicator");return r===null?null:(Array.isArray(r)&&(r=r.length===1?r[0]:r),_(r)?N(r,{class:p}):C&&_(C())?N(C(),{class:p}):c("span",{class:`${p} ${l}-dot-spin`},[c("i",{class:`${l}-dot-item`},null),c("i",{class:`${l}-dot-item`},null),c("i",{class:`${l}-dot-item`},null),c("i",{class:`${l}-dot-item`},null)]))}const $=c("div",T(T({},z),{},{class:v,"aria-live":"polite","aria-busy":s.value}),[u(n.value),S?c("div",{class:`${n.value}-text`},[S]):null]);if(d&&G(d).length){const l={[`${n.value}-container`]:!0,[`${n.value}-blur`]:s.value};return y(c("div",{class:[`${n.value}-nested-loading`,t.wrapperClassName,b.value]},[s.value&&c("div",{key:"loading"},[$]),c("div",{class:l,key:"container"},[d])]))}return y($)}}});w.setDefaultIndicator=tt;w.install=function(t){return t.component(w.name,w),t};const et={getGithubAuthUrl:()=>m.get("/api/v1/auth/github"),handleGithubCallback:t=>m.get(`/api/v1/auth/github/callback?code=${t}`),getCurrentUser:()=>m.get("/api/v1/auth/user")},at={uploadImage:t=>m.post("/api/v1/image/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),getUserImages:(t=1,e=10)=>m.get(`/api/v1/image/list?page=${t}&page_size=${e}`),deleteImage:t=>m.delete(`/api/v1/image/${t}`)},ot={getAllImages:t=>m.get("/api/v1/admin/images",{params:t}),getStats:()=>m.get("/api/v1/admin/stats")},st=F("user",{state:()=>({token:localStorage.getItem("token")||"",userId:localStorage.getItem("user_id")||"",username:localStorage.getItem("username")||"",userInfo:null,loading:!1,error:null}),getters:{isAuthenticated:t=>!!t.token,isAdmin:t=>{var e;return((e=t.userInfo)==null?void 0:e.is_admin)||!1}},actions:{setAuth(t,e,o=""){this.token=t,this.userId=e,this.username=o,localStorage.setItem("token",t),localStorage.setItem("user_id",e),o&&localStorage.setItem("username",o)},clearAuth(){this.token="",this.userId="",this.username="",this.userInfo=null,localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("username")},async fetchUserInfo(){try{this.loading=!0,this.error=null;const t=await et.getCurrentUser();return this.userInfo=t.user,t.user}catch(t){throw this.error=t.message||"获取用户信息失败",t}finally{this.loading=!1}},logout(){this.clearAuth()}}});export{w as S,et as a,ot as b,at as i,st as u};
